-- ============================================================
-- 删除 orders 表的数据
-- PostgreSQL 版本
-- 注意：此操作只删除表中的数据记录，表结构、索引、触发器、约束等都会保留
-- 警告：此操作会删除表中的所有记录，且不可恢复，执行前请确保已备份数据
-- ============================================================

-- ============================================================
-- 执行前检查
-- ============================================================

-- 1. 查看表是否存在
-- SELECT EXISTS (
--     SELECT FROM information_schema.tables 
--     WHERE table_schema = 'public' 
--     AND table_name = 'orders'
-- );

-- 2. 查看表中的数据量
-- SELECT COUNT(*) FROM orders;

-- ============================================================
-- 删除操作
-- ============================================================

-- 方法1：使用 DELETE 删除所有数据（可以回滚，但速度较慢）
-- 只删除数据，表结构、索引、触发器、约束等保持不变
-- 如果数据量很大，此方法可能较慢
DELETE FROM orders;

-- 方法2：使用 TRUNCATE 删除所有数据（速度快，但无法回滚）
-- 只删除数据，表结构、索引、触发器、约束等保持不变
-- 速度比 DELETE 快，但无法在事务中回滚
-- 注意：TRUNCATE 会重置自增序列（SERIAL），如果表有 SERIAL 类型的字段
-- TRUNCATE TABLE orders;

-- 方法3：使用 TRUNCATE RESTART IDENTITY（重置自增序列）
-- 如果表有 SERIAL 或 IDENTITY 类型的字段，使用此方法会重置序列从 1 开始
-- TRUNCATE TABLE orders RESTART IDENTITY;

-- ============================================================
-- 执行后验证
-- ============================================================

-- 验证数据是否已清空
-- SELECT COUNT(*) FROM orders;
-- 如果返回 0，说明数据已成功删除

-- 验证表结构是否保留
-- SELECT column_name, data_type 
-- FROM information_schema.columns 
-- WHERE table_name = 'orders';
-- 如果返回列信息，说明表结构已保留

-- ============================================================
-- 注意事项
-- ============================================================
-- 
-- 1. 删除数据前请务必备份数据
-- 2. DELETE 可以在事务中回滚，TRUNCATE 无法回滚
-- 3. TRUNCATE 速度更快，适合大量数据删除
-- 4. 删除数据后，表结构、索引、触发器、约束等都会保留
-- 5. 如果表有外键约束，TRUNCATE 可能需要先删除外键约束
-- 6. 此操作会删除所有数据，请在生产环境谨慎执行
-- 
-- ============================================================

