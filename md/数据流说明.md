# ğŸ“Š é‡‘ç„±ç„±ERPç³»ç»Ÿ - æ•°æ®æµè¯¦ç»†è¯´æ˜

> æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡µé¢ä¸­æ¯ä¸ªæ•°æ®ä»å“ªé‡Œæ¥ï¼Œåˆ°å“ªé‡Œå»ï¼Œä»¥åŠå¦‚ä½•æµè½¬çš„ã€‚

---

## ğŸ“‹ ç›®å½•

1. [æ•°æ®æµæ¦‚è§ˆ](#æ•°æ®æµæ¦‚è§ˆ)
2. [ä¸»é¡µé¢æ•°æ®æµ](#ä¸»é¡µé¢æ•°æ®æµ)
3. [æµ·å¤–ç‰©æµé¡µé¢æ•°æ®æµ](#æµ·å¤–ç‰©æµé¡µé¢æ•°æ®æµ)
4. [æ»é”€åº“å­˜ç®¡ç†é¡µé¢æ•°æ®æµ](#æ»é”€åº“å­˜ç®¡ç†é¡µé¢æ•°æ®æµ)
5. [æ—¥åˆ©æ¶¦æŠ¥è¡¨é¡µé¢æ•°æ®æµ](#æ—¥åˆ©æ¶¦æŠ¥è¡¨é¡µé¢æ•°æ®æµ)
6. [å¦‚ä½•è¿æ¥çœŸå®æ•°æ®](#å¦‚ä½•è¿æ¥çœŸå®æ•°æ®)

---

## ğŸ”„ æ•°æ®æµæ¦‚è§ˆ

### å½“å‰çŠ¶æ€ï¼š**æ‰€æœ‰æ•°æ®éƒ½æ˜¯ç¡¬ç¼–ç çš„å‡æ•°æ®ï¼ˆMock Dataï¼‰**

**ä»€ä¹ˆæ˜¯ç¡¬ç¼–ç ï¼Ÿ**
- å°±åƒæ‚¨åœ¨ä¸€å¼ çº¸ä¸Šç›´æ¥å†™ä¸Šæ•°å­—ï¼Œè€Œä¸æ˜¯ä»è®¡ç®—å™¨æˆ–æ•°æ®åº“é‡Œè¯»å–
- ç›®å‰æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ç›´æ¥å†™åœ¨ä»£ç é‡Œçš„ï¼Œä¸æ˜¯ä»æœåŠ¡å™¨è·å–çš„

**æ•°æ®æµè½¬è¿‡ç¨‹ï¼š**
```
æ•°æ®æºï¼ˆç¡¬ç¼–ç ï¼‰ â†’ ç»„ä»¶å†…éƒ¨å¤„ç† â†’ æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š â†’ ç”¨æˆ·äº¤äº’ â†’ æ›´æ–°æ˜¾ç¤º
```

---

## ğŸ  ä¸»é¡µé¢æ•°æ®æµï¼ˆapp/page.tsxï¼‰

### 1ï¸âƒ£ ä¾§è¾¹æ çŠ¶æ€æ•°æ®

#### **`sidebarOpen` çŠ¶æ€**

**æ•°æ®æ¥æºï¼š**
```typescript
const [sidebarOpen, setSidebarOpen] = useState(true)
```
- **åˆå§‹å€¼**ï¼š`true`ï¼ˆç¡¬ç¼–ç ï¼‰
- **æ¥æºä½ç½®**ï¼šç»„ä»¶å†…éƒ¨åˆ›å»ºçš„çŠ¶æ€å˜é‡
- **æ•°æ®ç±»å‹**ï¼šå¸ƒå°”å€¼ï¼ˆtrue = æ˜¾ç¤ºï¼Œfalse = éšè—ï¼‰

**æ•°æ®å»å‘ï¼š**
1. **æ§åˆ¶ä¾§è¾¹æ å®½åº¦**ï¼š
   ```typescript
   className={`${sidebarOpen ? "w-64" : "w-0"} ...`}
   ```
   - å¦‚æœ `sidebarOpen = true`ï¼Œä¾§è¾¹æ å®½åº¦æ˜¯ 264 åƒç´ 
   - å¦‚æœ `sidebarOpen = false`ï¼Œä¾§è¾¹æ å®½åº¦æ˜¯ 0ï¼ˆéšè—ï¼‰

2. **æ§åˆ¶èœå•æŒ‰é’®å›¾æ ‡**ï¼š
   ```typescript
   {sidebarOpen ? <X className="h-5 w-5" /> : <Menu className="h-5 w-5" />}
   ```
   - å¦‚æœ `sidebarOpen = true`ï¼Œæ˜¾ç¤º âŒ å›¾æ ‡
   - å¦‚æœ `sidebarOpen = false`ï¼Œæ˜¾ç¤º â˜° å›¾æ ‡

**æ•°æ®æ›´æ–°è§¦å‘ç‚¹ï¼š**
- ç”¨æˆ·ç‚¹å‡»èœå•æŒ‰é’®æ—¶ï¼š
  ```typescript
  onClick={() => setSidebarOpen(!sidebarOpen)}
  ```
  - ç‚¹å‡»åï¼ŒçŠ¶æ€ä¼šä» `true` å˜æˆ `false`ï¼Œæˆ–ä» `false` å˜æˆ `true`

**æ•°æ®æµå‘å›¾ï¼š**
```
åˆå§‹å€¼ (true)
    â†“
ç”¨æˆ·ç‚¹å‡»èœå•æŒ‰é’®
    â†“
setSidebarOpen(!sidebarOpen) æ›´æ–°çŠ¶æ€
    â†“
ä¾§è¾¹æ å®½åº¦å˜åŒ– + å›¾æ ‡å˜åŒ–
    â†“
ç½‘é¡µé‡æ–°æ¸²æŸ“æ˜¾ç¤ºæ–°çŠ¶æ€
```

---

#### **`activePage` çŠ¶æ€**

**æ•°æ®æ¥æºï¼š**
```typescript
const [activePage, setActivePage] = useState<"overseas" | "profit">("overseas")
```
- **åˆå§‹å€¼**ï¼š`"overseas"`ï¼ˆç¡¬ç¼–ç ï¼‰
- **æ¥æºä½ç½®**ï¼šç»„ä»¶å†…éƒ¨åˆ›å»ºçš„çŠ¶æ€å˜é‡
- **æ•°æ®ç±»å‹**ï¼šå­—ç¬¦ä¸²ï¼ˆ"overseas" æˆ– "profit"ï¼‰

**æ•°æ®å»å‘ï¼š**
1. **æ§åˆ¶é¡¶éƒ¨æ ‡é¢˜æ˜¾ç¤º**ï¼š
   ```typescript
   {activePage === "overseas" ? "æµ·å¤–ç‰©æµç®¡ç†" : "æ—¥åˆ©æ¶¦æŠ¥è¡¨"}
   ```
   - å¦‚æœ `activePage = "overseas"`ï¼Œæ˜¾ç¤º "æµ·å¤–ç‰©æµç®¡ç†"
   - å¦‚æœ `activePage = "profit"`ï¼Œæ˜¾ç¤º "æ—¥åˆ©æ¶¦æŠ¥è¡¨"

2. **æ§åˆ¶ä¸»å†…å®¹åŒºåŸŸæ˜¾ç¤ºå“ªä¸ªç»„ä»¶**ï¼š
   ```typescript
   {activePage === "overseas" ? <OverseasLogistics /> : <DailyProfitReport />}
   ```
   - å¦‚æœ `activePage = "overseas"`ï¼Œæ˜¾ç¤ºæµ·å¤–ç‰©æµç»„ä»¶
   - å¦‚æœ `activePage = "profit"`ï¼Œæ˜¾ç¤ºåˆ©æ¶¦æŠ¥è¡¨ç»„ä»¶

**æ•°æ®æ›´æ–°è§¦å‘ç‚¹ï¼š**
- ç”¨æˆ·ç‚¹å‡»ä¾§è¾¹æ çš„"æµ·å¤–ç‰©æµ"æŒ‰é’®ï¼š
  ```typescript
  onClick={() => setActivePage("overseas")}
  ```
- ç”¨æˆ·ç‚¹å‡»ä¾§è¾¹æ çš„"æ—¥åˆ©æ¶¦æŠ¥è¡¨"æŒ‰é’®ï¼š
  ```typescript
  onClick={() => setActivePage("profit")}
  ```

**æ•°æ®æµå‘å›¾ï¼š**
```
åˆå§‹å€¼ ("overseas")
    â†“
ç”¨æˆ·ç‚¹å‡»å¯¼èˆªæŒ‰é’®
    â†“
setActivePage("overseas" æˆ– "profit") æ›´æ–°çŠ¶æ€
    â†“
é¡¶éƒ¨æ ‡é¢˜å˜åŒ– + ä¸»å†…å®¹ç»„ä»¶åˆ‡æ¢
    â†“
ç½‘é¡µé‡æ–°æ¸²æŸ“æ˜¾ç¤ºå¯¹åº”é¡µé¢
```

---

### 2ï¸âƒ£ é¡µé¢æ ‡é¢˜æ•°æ®

#### **ä¾§è¾¹æ æ ‡é¢˜ "é‡‘ç„±ç„±æ•°æ®ç³»ç»Ÿ"**

**æ•°æ®æ¥æºï¼š**
```typescript
<h1>é‡‘ç„±ç„±æ•°æ®ç³»ç»Ÿ</h1>
```
- **æ¥æº**ï¼šç›´æ¥å†™åœ¨ JSX ä»£ç é‡Œçš„æ–‡æœ¬
- **ä½ç½®**ï¼š`app/page.tsx` ç¬¬ 23 è¡Œ

**æ•°æ®å»å‘ï¼š**
- ç›´æ¥æ˜¾ç¤ºåœ¨ä¾§è¾¹æ é¡¶éƒ¨
- ä¸ä¼šè¢«ä¿®æ”¹ï¼Œæ˜¯é™æ€æ–‡æœ¬

---

#### **é¡¶éƒ¨æ ‡é¢˜æ **

**æ•°æ®æ¥æºï¼š**
```typescript
{activePage === "overseas" ? "æµ·å¤–ç‰©æµç®¡ç†" : "æ—¥åˆ©æ¶¦æŠ¥è¡¨"}
```
- **æ¥æº**ï¼šæ ¹æ® `activePage` çŠ¶æ€åŠ¨æ€ç”Ÿæˆ
- **è®¡ç®—é€»è¾‘**ï¼šå¦‚æœå½“å‰é¡µé¢æ˜¯æµ·å¤–ç‰©æµï¼Œæ˜¾ç¤º"æµ·å¤–ç‰©æµç®¡ç†"ï¼Œå¦åˆ™æ˜¾ç¤º"æ—¥åˆ©æ¶¦æŠ¥è¡¨"

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨é¡¶éƒ¨æ ‡é¢˜æ ï¼ˆHeaderï¼‰ä¸­

---

## ğŸ“¦ æµ·å¤–ç‰©æµé¡µé¢æ•°æ®æµï¼ˆcomponents/overseas-logistics.tsxï¼‰

### 1ï¸âƒ£ ç‰©æµè®¢å•åˆ—è¡¨æ•°æ®

#### **`logisticsData` æ•°ç»„**

**æ•°æ®æ¥æºï¼š**
```23:51:components/overseas-logistics.tsx
// Mock data
const logisticsData: LogisticsRecord[] = [
  {
    id: "1",
    trackingNumber: "TRK2024001289",
    status: "è¿è¾“ä¸­",
    origin: "æ·±åœ³",
    destination: "çº½çº¦",
    shipDate: "2024-01-15",
    estimatedArrival: "2024-01-25",
  },
  // ... æ›´å¤šæ•°æ®
]
```

- **æ¥æºç±»å‹**ï¼šç¡¬ç¼–ç çš„å‡æ•°æ®ï¼ˆMock Dataï¼‰
- **æ•°æ®ä½ç½®**ï¼šç›´æ¥å†™åœ¨ç»„ä»¶ä»£ç é‡Œ
- **æ•°æ®ç±»å‹**ï¼šæ•°ç»„ï¼ŒåŒ…å«å¤šä¸ªç‰©æµè®°å½•å¯¹è±¡
- **æ¯ä¸ªè®°å½•åŒ…å«çš„å­—æ®µ**ï¼š
  - `id`: å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå­—ç¬¦ä¸²ï¼‰
  - `trackingNumber`: è´§è¿å•å·ï¼ˆå­—ç¬¦ä¸²ï¼‰
  - `status`: è®¢å•çŠ¶æ€ï¼ˆå­—ç¬¦ä¸²ï¼š"è¿è¾“ä¸­"ã€"å·²é€è¾¾"ã€"æ¸…å…³ä¸­"ï¼‰
  - `origin`: èµ·è¿åœ°ï¼ˆå­—ç¬¦ä¸²ï¼‰
  - `destination`: ç›®çš„åœ°ï¼ˆå­—ç¬¦ä¸²ï¼‰
  - `shipDate`: å‘è´§æ—¥æœŸï¼ˆå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼‰
  - `estimatedArrival`: é¢„è®¡åˆ°è¾¾æ—¥æœŸï¼ˆå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼‰

**æ•°æ®å»å‘ï¼š**

1. **ç»è¿‡è¿‡æ»¤å¤„ç†åæ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­**ï¼ˆè§ä¸‹é¢çš„ `filteredData`ï¼‰

2. **ç”¨äºè®¡ç®—ç»Ÿè®¡æ•°æ®**ï¼ˆè™½ç„¶ç›®å‰ç»Ÿè®¡æ•°æ®ä¹Ÿæ˜¯ç¡¬ç¼–ç çš„ï¼Œä½†å®é™…åº”è¯¥ä»è¿™é‡Œè®¡ç®—ï¼‰

**æ•°æ®æµå‘å›¾ï¼š**
```
ç¡¬ç¼–ç æ•°æ® (logisticsData)
    â†“
ç”¨æˆ·è¾“å…¥æœç´¢å…³é”®è¯ (searchQuery)
    â†“
è¿‡æ»¤å¤„ç† (filteredData)
    â†“
æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­
```

---

#### **`searchQuery` çŠ¶æ€**

**æ•°æ®æ¥æºï¼š**
```typescript
const [searchQuery, setSearchQuery] = useState("")
```
- **åˆå§‹å€¼**ï¼šç©ºå­—ç¬¦ä¸² `""`ï¼ˆç¡¬ç¼–ç ï¼‰
- **æ¥æºä½ç½®**ï¼šç»„ä»¶å†…éƒ¨åˆ›å»ºçš„çŠ¶æ€å˜é‡
- **æ•°æ®ç±»å‹**ï¼šå­—ç¬¦ä¸²

**æ•°æ®æ›´æ–°è§¦å‘ç‚¹ï¼š**
- ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥æ–‡å­—æ—¶ï¼š
  ```typescript
  onChange={(e) => setSearchQuery(e.target.value)}
  ```
  - æ¯æ¬¡è¾“å…¥å­—ç¬¦ï¼Œéƒ½ä¼šè§¦å‘æ›´æ–°
  - `e.target.value` æ˜¯ä»è¾“å…¥æ¡†è·å–çš„å½“å‰å€¼

**æ•°æ®å»å‘ï¼š**
1. **ç”¨äºè¿‡æ»¤ç‰©æµæ•°æ®**ï¼š
   ```typescript
   const filteredData = logisticsData.filter((record) =>
     record.trackingNumber.toLowerCase().includes(searchQuery.toLowerCase())
   )
   ```
   - è¿‡æ»¤é€»è¾‘ï¼šåœ¨è´§è¿å•å·ä¸­æŸ¥æ‰¾æ˜¯å¦åŒ…å«æœç´¢å…³é”®è¯
   - ä¸åŒºåˆ†å¤§å°å†™ï¼ˆä½¿ç”¨ `.toLowerCase()`ï¼‰

2. **ç»‘å®šåˆ°è¾“å…¥æ¡†çš„æ˜¾ç¤ºå€¼**ï¼š
   ```typescript
   value={searchQuery}
   ```
   - è¾“å…¥æ¡†æ˜¾ç¤ºçš„å†…å®¹ä¸ `searchQuery` çŠ¶æ€åŒæ­¥

**æ•°æ®æµå‘å›¾ï¼š**
```
åˆå§‹å€¼ ("")
    â†“
ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥
    â†“
setSearchQuery(è¾“å…¥çš„æ–‡å­—) æ›´æ–°çŠ¶æ€
    â†“
è§¦å‘è¿‡æ»¤é€»è¾‘ (filteredData)
    â†“
è¡¨æ ¼æ˜¾ç¤ºè¿‡æ»¤åçš„æ•°æ®
```

---

#### **`filteredData` è®¡ç®—å€¼**

**æ•°æ®æ¥æºï¼š**
```53:55:components/overseas-logistics.tsx
const filteredData = logisticsData.filter((record) =>
  record.trackingNumber.toLowerCase().includes(searchQuery.toLowerCase())
)
```

- **æ¥æºç±»å‹**ï¼šè®¡ç®—å¾—å‡ºçš„å€¼ï¼ˆä¸æ˜¯çŠ¶æ€ï¼Œæ˜¯æ´¾ç”Ÿæ•°æ®ï¼‰
- **è®¡ç®—é€»è¾‘**ï¼š
  1. éå† `logisticsData` æ•°ç»„ä¸­çš„æ¯ä¸ªè®°å½•
  2. æ£€æŸ¥è®°å½•çš„ `trackingNumber`ï¼ˆè´§è¿å•å·ï¼‰æ˜¯å¦åŒ…å« `searchQuery`ï¼ˆæœç´¢å…³é”®è¯ï¼‰
  3. å¦‚æœåŒ…å«ï¼Œä¿ç•™è¿™æ¡è®°å½•
  4. å¦‚æœä¸åŒ…å«ï¼Œè¿‡æ»¤æ‰è¿™æ¡è®°å½•
  5. è¿”å›è¿‡æ»¤åçš„æ–°æ•°ç»„

**æ•°æ®å»å‘ï¼š**
1. **æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­**ï¼š
   ```typescript
   {filteredData.map((record) => (
     <tr key={record.id}>
       <td>{record.trackingNumber}</td>
       <td>{record.status}</td>
       {/* ... æ›´å¤šå­—æ®µ */}
     </tr>
   ))}
   ```
   - éå† `filteredData` æ•°ç»„ï¼Œä¸ºæ¯æ¡è®°å½•åˆ›å»ºä¸€è¡Œè¡¨æ ¼

2. **çŠ¶æ€æ˜¾ç¤º**ï¼š
   - æ¯æ¡è®°å½•çš„çŠ¶æ€ä¼šæ ¹æ®çŠ¶æ€å€¼æ˜¾ç¤ºä¸åŒçš„é¢œè‰²æ ‡ç­¾ï¼š
     - "å·²é€è¾¾" â†’ ç»¿è‰²æ ‡ç­¾
     - "è¿è¾“ä¸­" â†’ æ©™è‰²æ ‡ç­¾
     - å…¶ä»–çŠ¶æ€ï¼ˆå¦‚"æ¸…å…³ä¸­"ï¼‰ â†’ ç´«è‰²æ ‡ç­¾

**æ•°æ®æµå‘å›¾ï¼š**
```
logisticsData (åŸå§‹æ•°æ®)
    â†“
    ç»“åˆ
    â†“
searchQuery (æœç´¢å…³é”®è¯)
    â†“
filter() æ–¹æ³•è¿‡æ»¤
    â†“
filteredData (è¿‡æ»¤åçš„æ•°æ®)
    â†“
map() æ–¹æ³•éå†
    â†“
æ¸²æŸ“åˆ°è¡¨æ ¼æ¯ä¸€è¡Œ
```

---

### 2ï¸âƒ£ ç»Ÿè®¡æ•°æ®ï¼ˆå¡ç‰‡æ˜¾ç¤ºï¼‰

#### **æ€»è¿å•æ•°ï¼š156**

**æ•°æ®æ¥æºï¼š**
```92:92:components/overseas-logistics.tsx
<p className="text-2xl font-semibold text-foreground">156</p>
```
- **æ¥æº**ï¼šç›´æ¥ç¡¬ç¼–ç åœ¨ JSX ä¸­çš„æ•°å­—
- **ä½ç½®**ï¼šç¬¬ 92 è¡Œ
- **æ•°æ®ç±»å‹**ï¼šç¡¬ç¼–ç çš„æ–‡æœ¬

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨ç¬¬ä¸€ä¸ªç»Ÿè®¡å¡ç‰‡ä¸­

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const totalOrders = logisticsData.length
// ç„¶ååœ¨æ˜¾ç¤ºæ—¶ä½¿ç”¨ï¼š
<p>{totalOrders}</p>
```

---

#### **è¿è¾“ä¸­ï¼š42**

**æ•°æ®æ¥æºï¼š**
```104:104:components/overseas-logistics.tsx
<p className="text-2xl font-semibold text-foreground">42</p>
```
- **æ¥æº**ï¼šç›´æ¥ç¡¬ç¼–ç çš„æ•°å­—
- **æ•°æ®ç±»å‹**ï¼šç¡¬ç¼–ç çš„æ–‡æœ¬

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨ç¬¬äºŒä¸ªç»Ÿè®¡å¡ç‰‡ä¸­

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const inTransitCount = logisticsData.filter(
  record => record.status === "è¿è¾“ä¸­"
).length
// ç„¶ååœ¨æ˜¾ç¤ºæ—¶ä½¿ç”¨ï¼š
<p>{inTransitCount}</p>
```

---

#### **æœ¬å‘¨æ–°å¢ï¼š23**

**æ•°æ®æ¥æºï¼š**
```116:116:components/overseas-logistics.tsx
<p className="text-2xl font-semibold text-foreground">23</p>
```
- **æ¥æº**ï¼šç›´æ¥ç¡¬ç¼–ç çš„æ•°å­—
- **æ•°æ®ç±»å‹**ï¼šç¡¬ç¼–ç çš„æ–‡æœ¬

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨ç¬¬ä¸‰ä¸ªç»Ÿè®¡å¡ç‰‡ä¸­

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const thisWeekStart = new Date() // è·å–æœ¬å‘¨å¼€å§‹æ—¥æœŸ
const thisWeekNew = logisticsData.filter(record => {
  const shipDate = new Date(record.shipDate)
  return shipDate >= thisWeekStart
}).length
// ç„¶ååœ¨æ˜¾ç¤ºæ—¶ä½¿ç”¨ï¼š
<p>{thisWeekNew}</p>
```

---

### 3ï¸âƒ£ å¯¼å‡ºåŠŸèƒ½æ•°æ®

#### **`handleExport` å‡½æ•°**

**æ•°æ®æ¥æºï¼š**
```57:60:components/overseas-logistics.tsx
const handleExport = () => {
  // Export functionality would be implemented here
  console.log("Exporting data...")
}
```

- **å½“å‰çŠ¶æ€**ï¼šåŠŸèƒ½æœªå®ç°ï¼Œåªæ˜¯å ä½ç¬¦
- **è§¦å‘æ—¶æœº**ï¼šç”¨æˆ·ç‚¹å‡»"å¯¼å‡ºæ•°æ®"æŒ‰é’®æ—¶

**æ•°æ®å»å‘ï¼ˆæœªæ¥å®ç°æ–¹å‘ï¼‰ï¼š**
1. **è·å–è¦å¯¼å‡ºçš„æ•°æ®**ï¼šåº”è¯¥æ˜¯ `filteredData` æˆ– `logisticsData`
2. **è½¬æ¢ä¸º Excel/CSV æ ¼å¼**
3. **ä¸‹è½½åˆ°ç”¨æˆ·ç”µè„‘**

**åº”è¯¥å¦‚ä½•å¤„ç†æ•°æ®ï¼š**
```typescript
const handleExport = () => {
  // 1. è·å–è¦å¯¼å‡ºçš„æ•°æ®ï¼ˆä½¿ç”¨è¿‡æ»¤åçš„æ•°æ®ï¼‰
  const dataToExport = filteredData
  
  // 2. è½¬æ¢ä¸º CSV æ ¼å¼
  const csvContent = convertToCSV(dataToExport)
  
  // 3. åˆ›å»ºä¸‹è½½é“¾æ¥
  const blob = new Blob([csvContent], { type: 'text/csv' })
  const url = window.URL.createObjectURL(blob)
  const link = document.createElement('a')
  link.href = url
  link.download = 'ç‰©æµæ•°æ®.csv'
  link.click()
}
```

---

## ğŸ’° æ—¥åˆ©æ¶¦æŠ¥è¡¨é¡µé¢æ•°æ®æµï¼ˆcomponents/daily-profit-report.tsxï¼‰

### 1ï¸âƒ£ å›¾è¡¨æ•°æ®

#### **`profitData` æ•°ç»„**

**æ•°æ®æ¥æºï¼š**
```20:28:components/daily-profit-report.tsx
const profitData = [
  { date: "01-15", profit: 4500, revenue: 12000, refund: 500 },
  { date: "01-16", profit: 5200, revenue: 14000, refund: 800 },
  { date: "01-17", profit: 4800, revenue: 13000, refund: 600 },
  // ... æ›´å¤šæ•°æ®
]
```

- **æ¥æºç±»å‹**ï¼šç¡¬ç¼–ç çš„å‡æ•°æ®ï¼ˆMock Dataï¼‰
- **æ•°æ®ä½ç½®**ï¼šç›´æ¥å†™åœ¨ç»„ä»¶ä»£ç é‡Œ
- **æ•°æ®ç±»å‹**ï¼šæ•°ç»„ï¼ŒåŒ…å«å¤šä¸ªæ—¥æœŸæ•°æ®å¯¹è±¡
- **æ¯ä¸ªå¯¹è±¡åŒ…å«çš„å­—æ®µ**ï¼š
  - `date`: æ—¥æœŸï¼ˆå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼šMM-DDï¼‰
  - `profit`: åˆ©æ¶¦ï¼ˆæ•°å­—ï¼Œå•ä½ï¼šå…ƒï¼‰
  - `revenue`: æ”¶å…¥ï¼ˆæ•°å­—ï¼Œå•ä½ï¼šå…ƒï¼‰
  - `refund`: é€€æ¬¾ï¼ˆæ•°å­—ï¼Œå•ä½ï¼šå…ƒï¼‰

**æ•°æ®å»å‘ï¼š**

1. **ç”¨äºåˆ©æ¶¦è¶‹åŠ¿æŠ˜çº¿å›¾**ï¼š
   ```typescript
   <LineChart data={profitData}>
     <Line dataKey="profit" name="åˆ©æ¶¦" />
     <Line dataKey="revenue" name="æ”¶å…¥" />
   </LineChart>
   ```
   - `dataKey="profit"` è¡¨ç¤ºç”¨ `profit` å­—æ®µç”»ä¸€æ¡çº¿ï¼ˆåˆ©æ¶¦çº¿ï¼‰
   - `dataKey="revenue"` è¡¨ç¤ºç”¨ `revenue` å­—æ®µç”»ä¸€æ¡çº¿ï¼ˆæ”¶å…¥çº¿ï¼‰
   - X è½´æ˜¾ç¤ºæ—¥æœŸï¼ˆ`date` å­—æ®µï¼‰

2. **ç”¨äºé€€æ¬¾åˆ†ææŸ±çŠ¶å›¾**ï¼š
   ```typescript
   <BarChart data={profitData}>
     <Bar dataKey="refund" name="é€€æ¬¾é‡‘é¢" />
   </BarChart>
   ```
   - `dataKey="refund"` è¡¨ç¤ºç”¨ `refund` å­—æ®µç”»æŸ±çŠ¶å›¾
   - X è½´æ˜¾ç¤ºæ—¥æœŸï¼ˆ`date` å­—æ®µï¼‰

**æ•°æ®æµå‘å›¾ï¼š**
```
ç¡¬ç¼–ç æ•°æ® (profitData)
    â†“
        åˆ†ä¸ºä¸¤æ¡è·¯å¾„
    â†“                  â†“
åˆ©æ¶¦è¶‹åŠ¿æŠ˜çº¿å›¾      é€€æ¬¾åˆ†ææŸ±çŠ¶å›¾
(profit, revenue)    (refund)
    â†“                  â†“
æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š        æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š
```

---

### 2ï¸âƒ£ ç»Ÿè®¡æ•°æ®ï¼ˆå¡ç‰‡æ˜¾ç¤ºï¼‰

#### **æ€»æ”¶å…¥ï¼šÂ¥92,500**

**æ•°æ®æ¥æºï¼š**
```43:43:components/daily-profit-report.tsx
<p className="text-3xl font-semibold text-foreground mt-2">Â¥92,500</p>
```
- **æ¥æº**ï¼šç›´æ¥ç¡¬ç¼–ç çš„æ•°å­—
- **æ•°æ®ç±»å‹**ï¼šç¡¬ç¼–ç çš„æ–‡æœ¬

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨ç¬¬ä¸€ä¸ªç»Ÿè®¡å¡ç‰‡ä¸­

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const totalRevenue = profitData.reduce((sum, item) => sum + item.revenue, 0)
// æˆ–è€…ä»æ•°æ®åº“è·å–æ±‡æ€»æ•°æ®
// ç„¶ååœ¨æ˜¾ç¤ºæ—¶ä½¿ç”¨ï¼š
<p>Â¥{totalRevenue.toLocaleString()}</p>
```

---

#### **æ€»åˆ©æ¶¦ï¼šÂ¥35,600**

**æ•°æ®æ¥æºï¼š**
```60:60:components/daily-profit-report.tsx
<p className="text-3xl font-semibold text-foreground mt-2">Â¥35,600</p>
```
- **æ¥æº**ï¼šç›´æ¥ç¡¬ç¼–ç çš„æ•°å­—
- **æ•°æ®ç±»å‹**ï¼šç¡¬ç¼–ç çš„æ–‡æœ¬

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨ç¬¬äºŒä¸ªç»Ÿè®¡å¡ç‰‡ä¸­

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const totalProfit = profitData.reduce((sum, item) => sum + item.profit, 0)
// ç„¶ååœ¨æ˜¾ç¤ºæ—¶ä½¿ç”¨ï¼š
<p>Â¥{totalProfit.toLocaleString()}</p>
```

---

#### **åˆ©æ¶¦ç‡ï¼š38.5%**

**æ•°æ®æ¥æºï¼š**
```30:30:components/daily-profit-report.tsx
const currentProfitRate = 38.5
```
- **æ¥æº**ï¼šç¡¬ç¼–ç çš„å¸¸é‡
- **æ•°æ®ç±»å‹**ï¼šæ•°å­—

**æ•°æ®å»å‘ï¼š**
1. **æ˜¾ç¤ºåœ¨ç¬¬ä¸‰ä¸ªç»Ÿè®¡å¡ç‰‡ä¸­**ï¼š
   ```typescript
   <p>{currentProfitRate}%</p>
   ```

2. **ç”¨äºè®¡ç®—å¢é•¿ç‡**ï¼š
   ```typescript
   const previousProfitRate = 35.2
   <span>+{(currentProfitRate - previousProfitRate).toFixed(1)}%</span>
   ```
   - æ˜¾ç¤ºè¾ƒä¸Šå‘¨å¢é•¿çš„ç™¾åˆ†æ¯”ï¼š38.5 - 35.2 = 3.3%

**æ•°æ®æµå‘å›¾ï¼š**
```
ç¡¬ç¼–ç å€¼ (currentProfitRate = 38.5)
    â†“
æ˜¾ç¤ºåœ¨å¡ç‰‡ä¸­ (38.5%)
    â†“
åŒæ—¶ç”¨äºè®¡ç®—å¢é•¿
(currentProfitRate - previousProfitRate)
    â†“
æ˜¾ç¤ºå¢é•¿ç‡ (+3.3%)
```

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const totalRevenue = profitData.reduce((sum, item) => sum + item.revenue, 0)
const totalProfit = profitData.reduce((sum, item) => sum + item.profit, 0)
const currentProfitRate = (totalProfit / totalRevenue) * 100
```

---

#### **é€€æ¬¾ç‡ï¼š2.8%**

**æ•°æ®æ¥æºï¼š**
```31:31:components/daily-profit-report.tsx
const currentRefundRate = 2.8
```
- **æ¥æº**ï¼šç¡¬ç¼–ç çš„å¸¸é‡
- **æ•°æ®ç±»å‹**ï¼šæ•°å­—

**æ•°æ®å»å‘ï¼š**
1. **æ˜¾ç¤ºåœ¨ç¬¬å››ä¸ªç»Ÿè®¡å¡ç‰‡ä¸­**ï¼š
   ```typescript
   <p>{currentRefundRate}%</p>
   ```

2. **ç”¨äºè®¡ç®—é™ä½ç‡**ï¼š
   ```typescript
   const previousRefundRate = 3.5
   <span>-{(previousRefundRate - currentRefundRate).toFixed(1)}%</span>
   ```
   - æ˜¾ç¤ºè¾ƒä¸Šå‘¨é™ä½çš„ç™¾åˆ†æ¯”ï¼š3.5 - 2.8 = 0.7%

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// åº”è¯¥è¿™æ ·è®¡ç®—ï¼š
const totalRevenue = profitData.reduce((sum, item) => sum + item.revenue, 0)
const totalRefund = profitData.reduce((sum, item) => sum + item.refund, 0)
const currentRefundRate = (totalRefund / totalRevenue) * 100
```

---

#### **å¢é•¿ç‡æ•°æ®ï¼ˆ+12.5%, +8.3% ç­‰ï¼‰**

**æ•°æ®æ¥æºï¼š**
- **æ€»æ”¶å…¥å¢é•¿ç‡ +12.5%**ï¼šç¡¬ç¼–ç åœ¨ JSX ä¸­
- **æ€»åˆ©æ¶¦å¢é•¿ç‡ +8.3%**ï¼šç¡¬ç¼–ç åœ¨ JSX ä¸­
- **åˆ©æ¶¦ç‡å¢é•¿ç‡ +3.3%**ï¼šé€šè¿‡ `currentProfitRate - previousProfitRate` è®¡ç®—å¾—å‡º
- **é€€æ¬¾ç‡é™ä½ç‡ -0.7%**ï¼šé€šè¿‡ `previousRefundRate - currentRefundRate` è®¡ç®—å¾—å‡º

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨å¯¹åº”çš„ç»Ÿè®¡å¡ç‰‡ä¸‹æ–¹ï¼Œæ˜¾ç¤ºè¶‹åŠ¿ï¼ˆå‘ä¸Šæˆ–å‘ä¸‹ï¼‰

**åº”è¯¥ä»å“ªé‡Œæ¥ï¼ˆæœªæ¥æ”¹è¿›ï¼‰ï¼š**
```typescript
// éœ€è¦ä»åç«¯è·å–ä¸Šå‘¨çš„æ•°æ®è¿›è¡Œå¯¹æ¯”
const lastWeekData = await fetchLastWeekData()
const currentWeekTotal = calculateCurrentWeekTotal(profitData)
const lastWeekTotal = calculateLastWeekTotal(lastWeekData)
const growthRate = ((currentWeekTotal - lastWeekTotal) / lastWeekTotal) * 100
```

---

## ğŸ“¦ æ»é”€åº“å­˜ç®¡ç†é¡µé¢æ•°æ®æµ

### 1ï¸âƒ£ æ»é”€åº“å­˜ç®¡ç† - å¤§ç›˜é¡µé¢

#### **`inventoryData` æ•°ç»„**

**æ•°æ®æ¥æºï¼š**
- ä» `inventory` æ•°æ®åº“è¡¨æŸ¥è¯¢
- é€šè¿‡ Server Action `fetchInventoryData` è·å–
- æ•°æ®ä½ç½®ï¼š`lib/inventory-data.ts` â†’ `getInventoryData()`

**æ•°æ®å»å‘ï¼š**
1. æ˜¾ç¤ºåœ¨ SKU æ˜ç»†è¡¨æ ¼ä¸­
2. ç”¨äºè®¡ç®—ç»Ÿè®¡æ•°æ®ï¼ˆç»Ÿè®¡å¡ç‰‡ï¼‰
3. æ”¯æŒæŒ‰æ ‡ç­¾ç­›é€‰ï¼ˆæ­£å¸¸é”€å”®ã€åœ¨å”®å¤©æ•°è¶…15å¤©ã€æœ‰åº“å­˜æ— é”€é‡ã€åº“å­˜å¾…å†²å¹³ï¼‰

**æ•°æ®æ›´æ–°æ—¶æœºï¼š**
- é¡µé¢é¦–æ¬¡åŠ è½½æ—¶
- å¯¼å…¥ Excel æ–‡ä»¶å
- ç‚¹å‡»ç»Ÿè®¡å¡ç‰‡ç­›é€‰æ—¶
- æœç´¢ SKU æ—¶

---

### 2ï¸âƒ£ æ»é”€åº“å­˜ç®¡ç† - ä»»åŠ¡åŠæ—¶é™é¡µé¢

#### **`taskData` æ•°ç»„**

**æ•°æ®æ¥æºï¼š**
- ä» `task` æ•°æ®åº“è¡¨æŸ¥è¯¢
- é€šè¿‡ Server Action `fetchTaskData` è·å–
- æ•°æ®ä½ç½®ï¼š`lib/inventory-data.ts` â†’ `getTaskData()`
- `task` è¡¨æ•°æ®ç”± `inventory` è¡¨è‡ªåŠ¨åŒæ­¥ï¼ˆç¬¦åˆç‰¹å®šæ¡ä»¶çš„è®°å½•ï¼‰

**æ•°æ®å»å‘ï¼š**
1. æ˜¾ç¤ºåœ¨ SKU æ˜ç»†è¡¨æ ¼ä¸­
2. ç”¨äºè®¡ç®—ä»»åŠ¡ç»Ÿè®¡æ•°æ®ï¼ˆ5ä¸ªç»Ÿè®¡å¡ç‰‡ï¼‰
3. æ”¯æŒç»„åˆç­›é€‰ï¼š
   - æ ‡ç­¾ç­›é€‰ï¼šåœ¨å”®å¤©æ•°è¶…15å¤©ã€æœ‰åº“å­˜æ— é”€é‡
   - çŠ¶æ€ç­›é€‰ï¼šæœªé€‰æ‹©æ–¹æ¡ˆã€ä»»åŠ¡æ­£åœ¨è¿›è¡Œä¸­ã€è¶…æ—¶ä»»åŠ¡
   - è´Ÿè´£äººç­›é€‰ï¼šæŒ‰è´Ÿè´£äººè¿‡æ»¤æ‰€æœ‰æ•°æ®

**æ•°æ®æ›´æ–°æ—¶æœºï¼š**
- é¡µé¢é¦–æ¬¡åŠ è½½æ—¶
- `inventory` è¡¨å¯¼å…¥åè‡ªåŠ¨åŒæ­¥
- ç‚¹å‡»"åˆ·æ–°ä»»åŠ¡è¡¨"æŒ‰é’®æ—¶
- é€‰æ‹©ç»Ÿè®¡å¡ç‰‡ç­›é€‰æ—¶
- é€‰æ‹©è´Ÿè´£äººç­›é€‰æ—¶
- æœç´¢ SKU æ—¶

---

#### **è´Ÿè´£äººç­›é€‰åŠŸèƒ½ (`chargeFilter`)**

**æ•°æ®æ¥æºï¼š**
```typescript
// app/page.tsx
const [selectedCharge, setSelectedCharge] = useState<string | null>(null)

// ä» task è¡¨è·å–è´Ÿè´£äººåˆ—è¡¨
const chargeList = await fetchTaskChargeList()
```

**æ•°æ®æµå‘ï¼š**
```
ç”¨æˆ·é€‰æ‹©è´Ÿè´£äºº
    â†“
app/page.tsx: selectedCharge çŠ¶æ€æ›´æ–°
    â†“
ä¼ é€’ç»™ TaskTimeline ç»„ä»¶ (chargeFilter prop)
    â†“
loadTaskData() å‡½æ•°æ¥æ”¶ chargeFilter
    â†“
è°ƒç”¨ fetchTaskData Server Action
    â†“
lib/inventory-data.ts: getTaskData() å‡½æ•°
    â†“
SQL æŸ¥è¯¢æ·»åŠ ç­›é€‰æ¡ä»¶: AND charge = ?
    â†“
è¿”å›ç­›é€‰åçš„æ•°æ®
    â†“
æ›´æ–° taskData çŠ¶æ€
    â†“
è¡¨æ ¼æ˜¾ç¤ºç­›é€‰åçš„æ•°æ®
```

**ç­›é€‰é€»è¾‘ï¼š**

1. **SQL å±‚é¢ç­›é€‰**ï¼ˆä¸»è¦æ–¹å¼ï¼‰ï¼š
   ```typescript
   // lib/inventory-data.ts
   if (chargeFilter) {
     sql += ' AND charge = ?'
     params.push(chargeFilter)
   }
   ```
   - åœ¨æ•°æ®åº“æŸ¥è¯¢æ—¶ç›´æ¥ç­›é€‰ï¼Œæ€§èƒ½æœ€ä¼˜
   - åªè¿”å›åŒ¹é…è´Ÿè´£äººçš„è®°å½•

2. **å‰ç«¯å¤‡ç”¨ç­›é€‰**ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰ï¼š
   ```typescript
   // å¦‚æœæ•°æ®åº“ç­›é€‰å¤±è´¥ï¼Œåœ¨å‰ç«¯å†æ¬¡ç­›é€‰
   if (chargeFilter) {
     filteredResults = filteredResults.filter((row) => row.charge === chargeFilter)
   }
   ```
   - ç¡®ä¿å³ä½¿æ•°æ®åº“ç­›é€‰å¤±è´¥ä¹Ÿèƒ½æ­£ç¡®æ˜¾ç¤º

**è”åŠ¨æ•ˆæœï¼š**

å½“é€‰æ‹©è´Ÿè´£äººåï¼Œä»¥ä¸‹æ•°æ®éƒ½ä¼šè”åŠ¨æ›´æ–°ï¼š

1. **ç»Ÿè®¡å¡ç‰‡æ•°æ®**ï¼š
   - åœ¨å”®å¤©æ•°è¶…15å¤©
   - æœ‰åº“å­˜æ— é”€é‡
   - æœªé€‰æ‹©æ–¹æ¡ˆ
   - ä»»åŠ¡æ­£åœ¨è¿›è¡Œä¸­
   - è¶…æ—¶ä»»åŠ¡
   - æ‰€æœ‰ç»Ÿè®¡æ•°æ®éƒ½ä¼šæŒ‰é€‰ä¸­çš„è´Ÿè´£äººé‡æ–°è®¡ç®—

2. **SKU æ˜ç»†è¡¨æ ¼**ï¼š
   - åªæ˜¾ç¤ºè¯¥è´Ÿè´£äººçš„ä»»åŠ¡è®°å½•
   - è¡¨æ ¼ä¸­çš„æ‰€æœ‰å­—æ®µï¼ˆSKUè´§å·ã€åº“å­˜æ•°é‡ã€æœ€è¿‘ä¸ƒå¤©é”€é‡ã€å¯å”®å¤©æ•°ã€è´Ÿè´£äººã€æ ‡è¯†ã€æ–¹æ¡ˆã€å€’è®¡æ—¶ï¼‰éƒ½ä¼šæ ¹æ®ç­›é€‰ç»“æœæ›´æ–°

3. **åˆ†é¡µé‡ç½®**ï¼š
   - ç­›é€‰åè‡ªåŠ¨é‡ç½®åˆ°ç¬¬ä¸€é¡µ
   - åˆ†é¡µä¿¡æ¯ä¼šæ ¹æ®ç­›é€‰åçš„æ•°æ®é‡æ›´æ–°

**æ•°æ®æ›´æ–°è§¦å‘ç‚¹ï¼š**
- ç”¨æˆ·åœ¨è´Ÿè´£äººä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©è´Ÿè´£äººæ—¶
- é€‰æ‹©"å…¨éƒ¨è´Ÿè´£äºº"æ—¶ï¼Œ`chargeFilter` è®¾ä¸º `null`ï¼Œæ˜¾ç¤ºæ‰€æœ‰æ•°æ®

**ä»£ç ä½ç½®ï¼š**
- è´Ÿè´£äººé€‰æ‹©å™¨ï¼š`app/page.tsx` (ç¬¬ 180-200 è¡Œ)
- æ•°æ®ä¼ é€’ï¼š`app/page.tsx` â†’ `components/task-timeline.tsx`
- æ•°æ®ç­›é€‰ï¼š`lib/inventory-data.ts` â†’ `getTaskData()` å‡½æ•°
- ç»Ÿè®¡æ•°æ®ç­›é€‰ï¼š`lib/inventory-data.ts` â†’ `getTaskStatistics()` å‡½æ•°

---

#### **ä»»åŠ¡ç»Ÿè®¡æ•°æ®**

**æ•°æ®æ¥æºï¼š**
- ä» `task` æ•°æ®åº“è¡¨ç»Ÿè®¡
- é€šè¿‡ Server Action `fetchTaskStatistics` è·å–
- æ•°æ®ä½ç½®ï¼š`lib/inventory-data.ts` â†’ `getTaskStatistics()`
- æ”¯æŒæŒ‰è´Ÿè´£äººç­›é€‰

**ç»Ÿè®¡æ•°æ®åŒ…æ‹¬ï¼š**
1. **åœ¨å”®å¤©æ•°è¶…15å¤©**ï¼š`label` åŒ…å« 4 çš„è®°å½•æ•°
2. **æœ‰åº“å­˜æ— é”€é‡**ï¼š`label` åŒ…å« 2 ä½†ä¸åŒ…å« 1 ä¸”ä¸åŒ…å« 5 çš„è®°å½•æ•°
3. **æœªé€‰æ‹©æ–¹æ¡ˆ**ï¼š`promised_land = 0` çš„è®°å½•æ•°
4. **ä»»åŠ¡æ­£åœ¨è¿›è¡Œä¸­**ï¼š`promised_land IN (1, 2, 3)` çš„è®°å½•æ•°
5. **è¶…æ—¶ä»»åŠ¡**ï¼šå…¨é‡æ•°æ®ï¼ˆå½“å‰ä¸åšç‰¹æ®Šç­›é€‰ï¼‰

**æ•°æ®å»å‘ï¼š**
- æ˜¾ç¤ºåœ¨ 5 ä¸ªç»Ÿè®¡å¡ç‰‡ä¸­
- å¡ç‰‡å¯ç‚¹å‡»ï¼Œç”¨äºç­›é€‰è¡¨æ ¼æ•°æ®
- æ”¯æŒç»„åˆç­›é€‰ï¼ˆæ ‡ç­¾ç­›é€‰ + çŠ¶æ€ç­›é€‰ï¼‰

**æ•°æ®æ›´æ–°æ—¶æœºï¼š**
- é¡µé¢é¦–æ¬¡åŠ è½½æ—¶
- é€‰æ‹©è´Ÿè´£äººç­›é€‰æ—¶
- ç‚¹å‡»"åˆ·æ–°ä»»åŠ¡è¡¨"æŒ‰é’®å

---

#### **æ–¹æ¡ˆé€‰æ‹©åŠŸèƒ½ (`promised_land`)**

**æ•°æ®æ¥æºï¼š**
- å­˜å‚¨åœ¨ `task` è¡¨çš„ `promised_land` å­—æ®µ
- åˆå§‹å€¼ä¸º 0ï¼ˆæœªé€‰æ‹©æ–¹æ¡ˆï¼‰

**æ•°æ®æµå‘ï¼š**
```
ç”¨æˆ·åœ¨è¡¨æ ¼ä¸­é€‰æ‹©æ–¹æ¡ˆ
    â†“
TaskTimeline: handlePromisedLandChange()
    â†“
è°ƒç”¨ updateTaskPromisedLand Server Action
    â†“
lib/inventory-data.ts: updateTaskPromisedLand()
    â†“
SQL UPDATE: UPDATE task SET promised_land = ? WHERE ware_sku = ?
    â†“
æ›´æ–°æˆåŠŸï¼Œæ›´æ–°æœ¬åœ° taskData çŠ¶æ€
    â†“
è¡¨æ ¼æ˜¾ç¤ºæ›´æ–°åçš„æ–¹æ¡ˆ
```

**æ–¹æ¡ˆæ˜ å°„ï¼š**
- `0` â†’ "æœªé€‰æ‹©æ–¹æ¡ˆ"
- `1` â†’ "é€€å›å‚å®¶"
- `2` â†’ "é™ä»·æ¸…ä»“"
- `3` â†’ "æ‰“å¤„ç†"

**æ•°æ®æ›´æ–°æ—¶æœºï¼š**
- ç”¨æˆ·åœ¨è¡¨æ ¼çš„æ–¹æ¡ˆä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©æ–¹æ¡ˆæ—¶
- æ–¹æ¡ˆå¯éšæ—¶é‡æ–°é€‰æ‹©

---

#### **å€’è®¡æ—¶å­—æ®µ (`count_down`)**

**æ•°æ®æ¥æºï¼š**
- å­˜å‚¨åœ¨ `task` è¡¨çš„ `count_down` å­—æ®µï¼ˆJSON ç±»å‹ï¼‰
- æ ¼å¼ï¼š`[æ•°å­—, æ•°å­—, æ—¥æœŸå­—ç¬¦ä¸²]`ï¼Œä¾‹å¦‚ `[0, 0, "2025-12-31"]`

**æ•°æ®è§£æï¼š**
```typescript
// lib/inventory-data.ts
if (row.count_down) {
  try {
    row.count_down = typeof row.count_down === 'string' 
      ? JSON.parse(row.count_down) 
      : row.count_down
  } catch (e) {
    console.warn('è§£æcount_downå­—æ®µå¤±è´¥:', row.count_down)
  }
}
```

**æ•°æ®æ˜¾ç¤ºï¼š**
- å¦‚æœ `count_down` å­˜åœ¨ä¸”ä¸ºæ•°ç»„ï¼Œæ˜¾ç¤ºä¸ºï¼š`0, 0, 2025-12-31`
- å¦‚æœ `count_down` ä¸ºå­—ç¬¦ä¸²ï¼Œç›´æ¥æ˜¾ç¤ºå­—ç¬¦ä¸²
- å¦‚æœ `count_down` ä¸ºç©ºæˆ–ä¸å­˜åœ¨ï¼Œæ˜¾ç¤º `-`

**æ•°æ®æ›´æ–°æ—¶æœºï¼š**
- ç”±åç«¯ç³»ç»Ÿå†™å…¥ï¼ˆç”¨æˆ·ä¸ç›´æ¥ç¼–è¾‘ï¼‰

---

## ğŸ”— å¦‚ä½•è¿æ¥çœŸå®æ•°æ®

### å½“å‰é—®é¢˜

**æ‰€æœ‰æ•°æ®éƒ½æ˜¯ç¡¬ç¼–ç çš„å‡æ•°æ®**ï¼Œè¿™æ„å‘³ç€ï¼š
- âŒ æ•°æ®ä¸ä¼šæ›´æ–°
- âŒ ç”¨æˆ·æ— æ³•çœ‹åˆ°çœŸå®çš„æ•°æ®
- âŒ æ— æ³•ä¸åç«¯æ•°æ®åº“äº¤äº’

### è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ Server Actions è¿æ¥æ•°æ®åº“

#### 1ï¸âƒ£ åˆ›å»ºæ•°æ®æœåŠ¡æ–‡ä»¶

åˆ›å»ºæ•°æ®æœåŠ¡æ–‡ä»¶ `lib/logistics-data.ts`ï¼š

```typescript
import { query } from '@/lib/db'

// è·å–ç‰©æµæ•°æ®
export async function getLogisticsData(searchNum?: string) {
  let sql = 'SELECT id, search_num, states, Ship_date FROM post_searchs WHERE 1=1'
  const params: any[] = []
  
  if (searchNum) {
    sql += ' AND search_num LIKE ?'
    params.push(`%${searchNum}%`)
  }
  
  sql += ' ORDER BY Ship_date DESC, id DESC'
  return await query(sql, params)
}

// è·å–ç»Ÿè®¡æ•°æ®
export async function getLogisticsStatistics() {
  // ç»Ÿè®¡æŸ¥è¯¢...
  return { in_transit, returned, not_online }
}
```

#### 2ï¸âƒ£ åˆ›å»º Server Actions

åˆ›å»º `app/actions/logistics.ts`ï¼š

```typescript
'use server'
import { getLogisticsData, getLogisticsStatistics } from '@/lib/logistics-data'

export async function fetchLogisticsData(searchNum?: string) {
  const data = await getLogisticsData(searchNum)
  return { success: true, data }
}

export async function fetchLogisticsStatistics() {
  const stats = await getLogisticsStatistics()
  return { success: true, data: stats }
}
```

#### 3ï¸âƒ£ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ Server Actions

**ä¿®æ”¹ `components/overseas-logistics.tsx`ï¼š**

```typescript
import { useState, useEffect } from "react"
import { fetchLogisticsData, fetchLogisticsStatistics } from "@/app/actions/logistics"

export default function OverseasLogistics() {
  const [logisticsData, setLogisticsData] = useState<LogisticsRecord[]>([])
  const [statistics, setStatistics] = useState({
    totalOrders: 0,
    inTransit: 0,
    thisWeekNew: 0
  })
  const [searchQuery, setSearchQuery] = useState("")
  const [loading, setLoading] = useState(true)

  // ç»„ä»¶åŠ è½½æ—¶è·å–æ•°æ®
  useEffect(() => {
    async function loadData() {
      try {
        setLoading(true)
        // è·å–ç‰©æµæ•°æ®
        const data = await fetchLogisticsData()
        setLogisticsData(data)
        
        // è·å–ç»Ÿè®¡æ•°æ®
        const stats = await fetchStatistics()
        setStatistics(stats)
      } catch (error) {
        console.error('åŠ è½½æ•°æ®å¤±è´¥:', error)
      } finally {
        setLoading(false)
      }
    }
    
    loadData()
  }, []) // ç©ºæ•°ç»„è¡¨ç¤ºåªåœ¨ç»„ä»¶é¦–æ¬¡åŠ è½½æ—¶æ‰§è¡Œ

  // è¿‡æ»¤æ•°æ®
  const filteredData = logisticsData.filter((record) =>
    record.trackingNumber.toLowerCase().includes(searchQuery.toLowerCase())
  )

  if (loading) {
    return <div>åŠ è½½ä¸­...</div>
  }

  return (
    <div className="space-y-6">
      {/* ä½¿ç”¨ç»Ÿè®¡æ•°æ® */}
      <Card>
        <p>æ€»è¿å•æ•°</p>
        <p>{statistics.totalOrders}</p> {/* ä½¿ç”¨ Server Actions è¿”å›çš„æ•°æ® */}
      </Card>
      {/* ... å…¶ä»–ä»£ç  */}
    </div>
  )
}
```

**ä¿®æ”¹ `components/daily-profit-report.tsx`ï¼š**

```typescript
import { useState, useEffect } from "react"
import { fetchProfitData } from "@/app/actions/profit"

export default function DailyProfitReport() {
  const [profitData, setProfitData] = useState([])
  const [statistics, setStatistics] = useState({
    totalRevenue: 0,
    totalProfit: 0,
    profitRate: 0,
    refundRate: 0
  })
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    async function loadData() {
      try {
        setLoading(true)
        // è·å–æœ€è¿‘7å¤©çš„æ•°æ®
        const endDate = new Date()
        const startDate = new Date()
        startDate.setDate(endDate.getDate() - 7)
        
        const data = await fetchProfitData(
          startDate.toISOString().split('T')[0],
          endDate.toISOString().split('T')[0]
        )
        setProfitData(data.records)
        setStatistics(data.summary)
      } catch (error) {
        console.error('åŠ è½½æ•°æ®å¤±è´¥:', error)
      } finally {
        setLoading(false)
      }
    }
    
    loadData()
  }, [])

  // è®¡ç®—å¢é•¿ç‡ï¼ˆéœ€è¦è·å–ä¸Šå‘¨æ•°æ®å¯¹æ¯”ï¼‰
  // ...

  if (loading) {
    return <div>åŠ è½½ä¸­...</div>
  }

  return (
    <div className="space-y-6">
      <Card>
        <p>æ€»æ”¶å…¥</p>
        <p>Â¥{statistics.totalRevenue.toLocaleString()}</p> {/* ä½¿ç”¨ Server Actions è¿”å›çš„æ•°æ® */}
      </Card>
      {/* ... å…¶ä»–ä»£ç  */}
    </div>
  )
}
```

#### 3ï¸âƒ£ æ•°æ®æµç¨‹å›¾ï¼ˆä½¿ç”¨ Server Actionsï¼‰

```
ç”¨æˆ·æ‰“å¼€ç½‘é¡µ
    â†“
ç»„ä»¶åŠ è½½ (useEffect è§¦å‘)
    â†“
è°ƒç”¨ Server Action (fetchLogisticsData)
    â†“
Server Action åœ¨æœåŠ¡ç«¯æ‰§è¡Œ
    â†“
ç›´æ¥æŸ¥è¯¢æ•°æ®åº“ (lib/logistics-data.ts)
    â†“
è¿”å›æ•°æ®åˆ°ç»„ä»¶
    â†“
ç»„ä»¶æ›´æ–°çŠ¶æ€ (setLogisticsData)
    â†“
ç»„ä»¶é‡æ–°æ¸²æŸ“
    â†“
æ•°æ®æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š
    â†“
ç”¨æˆ·äº¤äº’ï¼ˆæœç´¢ã€ç­›é€‰ç­‰ï¼‰
    â†“
è°ƒç”¨ Server Action é‡æ–°æŸ¥è¯¢
    â†“
æ›´æ–°æ˜¾ç¤º
```

---

## ğŸ“Š æ•°æ®æµå‘æ€»ç»“è¡¨

| æ•°æ®åç§° | å½“å‰æ¥æº | å½“å‰å»å‘ | åº”è¯¥ä»å“ªé‡Œæ¥ | æ•°æ®æ›´æ–°æ—¶æœº |
|---------|---------|---------|-------------|-------------|
| `sidebarOpen` | useState åˆå§‹å€¼ | æ§åˆ¶ä¾§è¾¹æ æ˜¾ç¤º/éšè— | - | ç”¨æˆ·ç‚¹å‡»èœå•æŒ‰é’® |
| `activePage` | useState åˆå§‹å€¼ | æ§åˆ¶æ˜¾ç¤ºå“ªä¸ªé¡µé¢ | - | ç”¨æˆ·ç‚¹å‡»å¯¼èˆªæŒ‰é’® |
| `logisticsData` | Server Actions | æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­ | æ•°æ®åº“æŸ¥è¯¢ | é¡µé¢åŠ è½½æ—¶ |
| `searchQuery` | ç”¨æˆ·è¾“å…¥ | ç”¨äºæœç´¢æ•°æ® | - | ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥ |
| `filteredData` | Server Actions | æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­ | æ•°æ®åº“æŸ¥è¯¢ | `searchQuery` å˜åŒ–æ—¶ |
| æ€»è¿å•æ•° | Server Actions | ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤º | ä»æ•°æ®åº“ç»Ÿè®¡ | æ•°æ®åŠ è½½æ—¶ |
| è¿è¾“ä¸­ | Server Actions | ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤º | ä»æ•°æ®åº“ç»Ÿè®¡ | æ•°æ®åŠ è½½æ—¶ |
| `profitData` | Server Actions | å›¾è¡¨æ˜¾ç¤º | æ•°æ®åº“æŸ¥è¯¢ | é¡µé¢åŠ è½½æ—¶ |
| æ€»æ”¶å…¥ | Server Actions | ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤º | ä»æ•°æ®åº“è®¡ç®— | æ•°æ®åŠ è½½æ—¶ |
| åˆ©æ¶¦ç‡ | Server Actions | ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤º | ä»æ•°æ®åº“è®¡ç®— | æ•°æ®åŠ è½½æ—¶ |
| `inventoryData` | Server Actions | è¡¨æ ¼æ˜¾ç¤º | æ•°æ®åº“æŸ¥è¯¢ï¼ˆinventoryè¡¨ï¼‰ | é¡µé¢åŠ è½½æ—¶ã€å¯¼å…¥åã€ç­›é€‰æ—¶ |
| åº“å­˜ç»Ÿè®¡æ•°æ® | Server Actions | ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤º | ä»æ•°æ®åº“ç»Ÿè®¡ | æ•°æ®åŠ è½½æ—¶ |
| task è¡¨æ•°æ® | Server Actions | task è¡¨æ˜¾ç¤º | æ•°æ®åº“æŸ¥è¯¢ï¼ˆtaskè¡¨ï¼‰ | å¯¼å…¥åè‡ªåŠ¨åŒæ­¥ã€æ‰‹åŠ¨åˆ·æ–°æ—¶ |
| `chargeFilter` | ç”¨æˆ·é€‰æ‹© | ç­›é€‰ä»»åŠ¡æ•°æ® | - | ç”¨æˆ·é€‰æ‹©è´Ÿè´£äººæ—¶ |
| ä»»åŠ¡ç»Ÿè®¡æ•°æ® | Server Actions | ç»Ÿè®¡å¡ç‰‡æ˜¾ç¤º | ä»æ•°æ®åº“ç»Ÿè®¡ï¼ˆæ”¯æŒè´Ÿè´£äººç­›é€‰ï¼‰ | æ•°æ®åŠ è½½æ—¶ã€è´Ÿè´£äººç­›é€‰å˜åŒ–æ—¶ |

---

## ğŸ¯ å…³é”®è¦ç‚¹æ€»ç»“

1. **å½“å‰æ‰€æœ‰ä¸šåŠ¡æ•°æ®éƒ½æ˜¯ç¡¬ç¼–ç çš„å‡æ•°æ®**
   - ç‰©æµè®¢å•æ•°æ®ã€åˆ©æ¶¦æ•°æ®ã€ç»Ÿè®¡æ•°æ®éƒ½æ˜¯å†™æ­»åœ¨ä»£ç é‡Œçš„

2. **åªæœ‰ç•Œé¢äº¤äº’çŠ¶æ€æ˜¯åŠ¨æ€çš„**
   - ä¾§è¾¹æ çš„æ˜¾ç¤º/éšè—
   - é¡µé¢åˆ‡æ¢
   - æœç´¢è¿‡æ»¤

3. **æ•°æ®æµå‘éµå¾ª React çš„å•å‘æ•°æ®æµ**
   - æ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶
   - ç”¨æˆ·äº¤äº’è§¦å‘çŠ¶æ€æ›´æ–°
   - çŠ¶æ€æ›´æ–°å¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“

4. **è¿æ¥çœŸå®æ•°æ®éœ€è¦ï¼š**
   - åˆ›å»º Server Actions
   - åˆ›å»ºæ•°æ®æœåŠ¡å±‚ï¼ˆç›´æ¥è¿æ¥æ•°æ®åº“ï¼‰
   - ä½¿ç”¨ `useEffect` åœ¨ç»„ä»¶åŠ è½½æ—¶è°ƒç”¨ Server Actions
   - ä½¿ç”¨ `useState` å­˜å‚¨æ•°æ®
   - å¤„ç†åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€

---

å¸Œæœ›è¿™ä¸ªè¯¦ç»†çš„æ•°æ®æµè¯´æ˜æ–‡æ¡£å¯¹æ‚¨æœ‰å¸®åŠ©ï¼é¡¹ç›®ç°åœ¨ä½¿ç”¨ Server Actions ç›´æ¥è¿æ¥æ•°æ®åº“ï¼Œæ— éœ€ API è·¯ç”±å±‚ã€‚

